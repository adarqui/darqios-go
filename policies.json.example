{
	"name" : "general",
	"base" : "/etc/darqios/",
	"policies" : [
		{
			"name" : "State",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "",
			"interval" : 5,
			"params" : [ "load", "memory", "processes", "disk", "users", "net" ],
			"thresholds" : [],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Ping",
			"desc" : "If we are unable to ping out to the internet, we have a problem",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "alive",
			"interval" : 30,
			"params" : [ "8.8.8.8", "4.2.2.2" ],
			"thresholds" : [],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Load",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "last1min",
			"interval" : 60,
			"params" : [],
			"thresholds" : [ "40", "70", "100" ],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Load",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "last5min",
			"interval" : 60,
			"params" : [],
			"thresholds" : [ "", "", "50" ],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Load",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "last15min",
			"interval" : 60,
			"params" : [],
			"thresholds" : [ "", "", "40" ],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Memory",
			"hosts" : [ "" ],
			"groups" : [],
			"params" : [],
			"idx" : "free",
			"interval" : 60,
			"params" : [],
			"thresholds" : [ "30", "20", "10" ],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Disk",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "free",
			"interval" : 60,
			"params" : [ "/" ],
			"thresholds" : [ "", "", "90" ],
			"mitigate" : [ "", "", "disk/clean.sh" ],
			"active" : true
		},
		{
			"name" : "Disk",
			"hosts" : [ "" ],
			"groups" : [],
			"interval" : 60,
			"idx" : "free",
			"params" : [ "/ebs" ],
			"thresholds" : [ "", "", "90" ],
			"mitigate" : [ "", "", "disk/clean.sh" ],
			"active" : true
		},
		{
			"name" : "Process",
			"desc" : "Notify us immediately when these critical services are not running",
			"hosts" : [],
			"groups" : [ "chef" ],
			"interval" : 10,
			"idx" : "!running",
			"level" : "high",
			"params" : [ "mongod", "redis-server", "ec2web.js", "sshd" ],
			"thresholds" : [],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Process",
			"desc" : "Nginx",
			"hosts" : [],
			"groups" : [ "nginx" ],
			"idx" : "!running",
			"interval" : 10,
			"level" : "high",
			"params" : [ "nginx" ],
			"thresholds" : [],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Process",
			"desc" : "Aspera",
			"hosts" : [],
			"groups" : [ "aspera" ],
			"idx" : "!running",
			"interval" : 10,
			"level" : "high",
			"params" : [ "asperalee", "asperanoded", "asperaredisd" ],
			"thresholds" : [],
			"mitigate" : [ "aspera_restart.sh" ],
			"active" : true
		},
		{
			"name" : "Process",
			"desc" : "php5-fpm",
			"hosts" : [],
			"groups" : [ "php5fpm" ],
			"idx" : "!running",
			"interval" : 10,
			"level" : "high",
			"params" : [ "php5-fpm" ],
			"thresholds" : [],
			"mitigate" : [ "php5fpm_restart.sh" ],
			"active" : true
		},
		{
			"name" : "Process",
			"desc" : "Redis server",
			"hosts" : [],
			"groups" : [ "redis" ],
			"idx" : "!running",
			"interval" : 10,
			"level" : "high",
			"params" : [ "redis-server" ],
			"thresholds" : [],
			"mitigate" : [ "redis_restart.sh" ],
			"active" : true
		},
		{
			"name" : "Process",
			"desc" : "Notify us when these services are running",
			"hosts" : [ "" ],
			"groups" : [],
			"idx" : "running",
			"level" : "high",
			"interval" : 60,
			"params" : [ "tcpdump" ],
			"thresholds" : [ "120", "300", "600" ],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Network",
			"desc" : "Notify when elastic is not listening",
			"hosts" : [],
			"groups" : [ "elastic" ],
			"idx" : "port_any",
			"interval" : 10,
			"params" : [ "9200" ],
			"thresholds" : [],
			"mitigate" : [ "restart_elastic.sh" ],
			"active" : true
		},
		{
			"name" : "Network",
			"desc" : "This server should never send or receive Blah bytes per second",
			"hosts" : [],
			"groups" : "test_bandwidth",
			"idx" : "bandwidth_any",
			"interval" : 10,
			"params" : [],
			"thresholds" : [ "100000", "1000000", "10000000" ],
			"mitigate" : [],
			"active" : true
		}
	],
	"missing" : [
		{
			"name" : "Database Server",
			"desc" : "Mongo or redis servers are missing",
			"hosts" : [],
			"group" : [ "mongo", "redis" ],
			"params" : [ "critical.sh", "critical.sh", "critical.sh" ],
			"thresholds" : [ "30", "60", "90" ],
			"mitigate" : [],
			"active" : true
		},
		{
			"name" : "Default",
			"hosts" : [ "" ],
			"group" : [],
			"mitigate" : [],
			"thresholds" : [ "30", "60", "90" ],
			"active" : true
		}
	],
	"ignore" : [
		"local5",
		"local6",
		"local7"
	],
	"options" : {
	},
	"alerts" : {
		"low" : {
			"scripts" : [ "low.sh" ]
		},
		"med" : {
			"scripts" : [ "med.sh" ]
		},
		"high" : {
			"scripts" : [ "high.sh" ]
		}
	}
}
